<div *ngIf="showContents">
  <div class="container-fluid">
    <!-- TITLE -->
    <div class="jumbotron jumbotron-fluid text-white blueBkg animated fadeIn">
      <div class="container">
        <div class="d-flex justify-content-between">
          <div>
            <span><h1 class="display-3">Consulta de Asistencia</h1></span>
            <p class="lead">Detalle de horarios, ausentismos, retardos, etc.</p>
          </div>
          <div>
            <img src="assets/img/bePriceBCO.png" height="150" width="150" alt="">
          </div>
        </div>
        <div class="container">
          <div class="form-row align-items-center">
            <div class="col-auto">
              <select class="custom-select mb-2 mr-sm-2 mb-sm-0" (change)="pcrcChange($event)" id="pcrc">
                <option selected *ngIf="!deps">Loading... <span *ngIf="loading"><i class="fa fa-fw fa-spinner fa-pulse"></i></span></option>
                <option selected *ngIf="deps">Selecciona...</option>
                <option [value]="pcrc.id" *ngFor="let pcrc of deps">{{ pcrc.Departamento }}</option>
                <option value='0' *ngIf="deps">Todos</option>
              </select>
            </div>
            <div class="col-auto">
              <label class="sr-only" for="selectedDate">Fechas</label>
              <div class="col-auto input-group">
                <div class="input-group-prepend">
                  <span class="input-group-text"><i class="fa fa-calendar fa-fw"></i></span>
                </div>
                <input
                  daterangepicker
                  (selected)="setVal($event.start, $event.end)"
                  class="form-control mb-2 mb-sm-0" type="text" [value]="searchCriteria.value" id="selectedDate">
              </div>
            </div>
            <div class="col-auto" *ngIf="asistData">
              <input
                  class="form-control mb-2 mb-sm-0" type="text" [(ngModel)]="searchFilter" name="searchFilter" id="filterSearch" placeholder="Filtrar por">
            </div>
            <div class="col-auto">
              <button
                type="submit"
                class="btn btn-primary"
                (click)="getAsistencia( searchCriteria.skill, searchCriteria.start, searchCriteria.end )"
                [disabled]="loading || searchCriteria.skill==''">Consultar <span *ngIf="loading"><i class="fa fa-fw fa-spinner fa-pulse"></i></span></button>
            </div>
          </div>
        </div>
        <br>
        <div class="container">
          <div class="row">
            <div class="col-lg">
              <div style="text-align: center" class="p-2">
                <ui-switch
                  color="green"
                  size= "small"
                  name='ch_jornada'
                  [(ngModel)]="showOpts.ch_jornada"
                ></ui-switch>
                <p style="margin-top: -10px">
                  <small *ngIf="!tdInfo">Jornada</small>
                </p>
              </div>
            </div>
            <div class="col-lg">
              <div style="text-align: center" class="p-2">
                <ui-switch
                  color="green"
                  size= "small"
                  name='ch_comida'
                  [(ngModel)]="showOpts.ch_comida"
                ></ui-switch>
                <p style="margin-top: -10px">
                  <small *ngIf="!tdInfo">Comida</small>
                </p>
              </div>
            </div>
            <div class="col-lg">
              <div style="text-align: center" class="p-2">
                <ui-switch
                  color="green"
                  size= "small"
                  name='ch_x'
                  [(ngModel)]="showOpts.ch_x"
                ></ui-switch>
                <p style="margin-top: -10px">
                  <small *ngIf="!tdInfo">Horas Extra</small>
                </p>
              </div>
            </div>
            <div class="col-lg">
              <div style="text-align: center" class="p-2">
                <ui-switch
                  color="green"
                  size= "small"
                  name='ch_excep'
                  [(ngModel)]="showOpts.ch_excep"
                ></ui-switch>
                <p style="margin-top: -10px">
                  <small *ngIf="!tdInfo">Excepciones</small>
                </p>
              </div>
            </div>
            <div class="col-lg">
              <div style="text-align: center" class="p-2">
                <ui-switch
                  color="green"
                  size= "small"
                  name='ch_ret'
                  [(ngModel)]="showOpts.ch_ret"
                ></ui-switch>
                <p style="margin-top: -10px">
                  <small *ngIf="!tdInfo">RT</small>
                </p>
              </div>
            </div>
            <div class="col-lg">
              <div style="text-align: center" class="p-2">
                <ui-switch
                  color="green"
                  size= "small"
                  name='ch_sa'
                  [(ngModel)]="showOpts.ch_sa"
                ></ui-switch>
                <p style="margin-top: -10px">
                  <small *ngIf="!tdInfo">SA</small>
                </p>
              </div>
            </div>
            <div class="col-lg">
              <div style="text-align: center" class="p-2">
                <ui-switch
                  color="green"
                  size= "small"
                  name='sh_p'
                  [(ngModel)]="showOpts.sh_p"
                ></ui-switch>
                <p style="margin-top: -10px">
                  <small *ngIf="!tdInfo">Cumplimiento</small>
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

</div>

<ng-container *ngIf="asistData && showContents">
  <div class="container-fluid" >
    <table class="table table-fluid table-striped table-bordered table-hover table-sm table-responsive">
      <thead>
        <tr>
          <th style="min-width: 130px;">Asesor</th>
          <th>Departamento</th>
          <th>Puesto</th>
          <th *ngFor="let date of datesData | keys" class="text-center">{{ date }}</th>
        </tr>
      </thead>
      <tbody>
        <ng-container *ngFor="let rac of orederedKeys">
          <tr>
            <td scope="row"><small>{{ asistData[rac].Nombre }} <a class="cursor: pointer" [routerLink]="['/detail-asesor',rac]" target="_blank"><i class="fa fa-fw fa-info-circle"></i></a></small></td>
            <td scope="row"><small class="text-center">{{ asistData[rac].Departamento }}</small></td>
            <td scope="row"><small class="text-center">{{ asistData[rac].PuestoName }}</small></td>
            <td *ngFor="let date of datesData | keys" class="text-xs-center" style="max-width: 180px">
              <app-jornadas
                [asistData]="asistData[rac].data[date]"
                [showOpts]="showOpts">
              </app-jornadas>
            </td>
          </tr>
        </ng-container>
      </tbody>
    </table>
  </div>
</ng-container>

<!-- Ausentismos Agregar -->
<app-add-ausentismo (notif)="ausentNotif($event)" ></app-add-ausentismo>
